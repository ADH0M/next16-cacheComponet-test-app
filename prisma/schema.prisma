generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

// ====== Existing Models ======

model Post {
  id       String    @id @default(auto()) @map("_id") @db.ObjectId
  title    String
  body     String
  author   User      @relation(fields: [authorId], references: [id])
  authorId String    @db.ObjectId
  comments Comment[]
}

model User {
  id       String    @id @default(auto()) @map("_id") @db.ObjectId
  email    String    @unique
  name     String?
  address  Address?
  posts    Post[]
  password String?
  products Product[] @relation("OwnerProducts")
}

model Comment {
  id      String @id @default(auto()) @map("_id") @db.ObjectId
  comment String
  post    Post   @relation(fields: [postId], references: [id])
  postId  String @db.ObjectId
}

// Embedded document
type Address {
  street String
  city   String
  state  String
  zip    String
}

// ====== NEW: Product & Related Models ======

model Product {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  description String?
  price       Float // in smallest currency unit (e.g., cents) or use Decimal
  currency    String   @default("USD")
  stock       Int      @default(0)
  published   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  owner   User?   @relation("OwnerProducts", fields: [ownerId], references: [id])
  ownerId String? @db.ObjectId

  category   Category? @relation(fields: [categoryId], references: [id])
  categoryId String?   @db.ObjectId

  images Image[]
  tags   String[] // e.g., ["electronics", "gadget"]
}

model Category {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  name        String    @unique
  description String?
  products    Product[]
}

// Embedded document for image metadata
type Image {
  url    String
  alt    String?
  isMain Boolean @default(false)
}
